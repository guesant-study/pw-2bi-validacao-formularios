<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="/imgs/favicon.png" type="image/png" />
    <title>Cadastrar Promoção - Painel - Hamburgueria Siri Cascudo</title>

    <link rel="stylesheet" href="/css/geral.css" />
    <link rel="stylesheet" href="/css/bootstrap.min.css" />

    <link rel="stylesheet" href="/css/parts/formulario.css" />
    <link rel="stylesheet" href="/css/pages/admin-pedidos-cadastrar.css" />
  </head>
  <body>
    <header class="app-header">
      <div class="app-container app-header-container">
        <div>
          <a class="app-header-brand" href="/index.html">
            <img
              src="/imgs/logo.webp"
              alt="Logo da Hamburgueria Siri Cascudo"
            />
          </a>
        </div>
      </div>
    </header>

    <main>
      <div class="app-container py-4">
        <h1 class="text-center">Cadastrar Promoção</h1>

        <form id="form-principal"></form>

        <div>
          <div class="mb-3 campo-gp">
            <label for="field-data-inicio" class="form-label">
              Data de Início
            </label>

            <input
              required
              minlength="3"
              class="form-control"
              type="datetime-local"
              id="field-data-inicio"
              form="form-principal"
              name="inputCadastrarPromocaoDataInicio"
            />

            <span class="mensagem-erro" data-erro=""></span>
          </div>

          <div class="mb-3 campo-gp">
            <label for="field-data-termino" class="form-label">
              Data de Término
            </label>

            <input
              required
              minlength="3"
              id="field-data-termino"
              class="form-control"
              type="datetime-local"
              form="form-principal"
              name="inputCadastrarPromocaoDataInicio"
            />

            <span class="mensagem-erro" data-erro=""></span>
          </div>

          <div class="d-grid gap-2">
            <button
              type="submit"
              form="form-principal"
              class="btn btn-primary full-width"
            >
              Registrar Promoção
            </button>
          </div>
        </div>
      </div>
    </main>

    <script src="/js/bootstrap.bundle.min.js"></script>

    <script>
      const inputDataTermino = document.querySelector("#field-data-termino");
      const inputDataInicio = document.querySelector("#field-data-inicio");

      const getDataTermino = () => {
        const dataTermino =
          inputDataTermino.value && new Date(inputDataTermino.value);

        return dataTermino ?? null;
      };

      const getDataInicio = () => {
        const dataInicio =
          inputDataInicio.value && new Date(inputDataInicio.value);

        return dataInicio ?? null;
      };

      const getMsgErro = (input) => {
        const gp = input.closest(".campo-gp");
        const msgErro = gp.querySelector(".mensagem-erro");

        return msgErro;
      };

      const validateDataTermino = () => {
        const msgErro = getMsgErro(inputDataTermino);

        const dataInicio = getDataInicio();
        const dataTermino = getDataTermino();

        msgErro.textContent = "";

        if (!dataTermino) {
          msgErro.textContent = "A data de término é inválida.";
        }

        if (dataTermino < dataInicio) {
          msgErro.textContent =
            "A data de término deve ser maior que a data de início.";
        }
      };

      const resetDataTermino = () => {
        const msgErro = getMsgErro(inputDataTermino);
        msgErro.textContent = "";
      };

      const validateDataInicio = () => {
        const msgErro = getMsgErro(inputDataInicio);

        const dataInicio = getDataInicio();

        msgErro.textContent = "";

        if (!dataInicio) {
          msgErro.textContent = "A data de início é inválida.";
        }
      };

      const resetDataInicio = () => {
        const msgErro = getMsgErro(inputDataInicio);
        msgErro.textContent = "";
      };

      inputDataInicio.addEventListener("change", () => resetDataInicio());
      inputDataInicio.addEventListener("blur", () => validateDataInicio());

      inputDataTermino.addEventListener("change", () => resetDataTermino());
      inputDataTermino.addEventListener("blur", () => validateDataTermino());
    </script>
  </body>
</html>
